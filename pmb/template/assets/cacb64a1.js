import{bh as Ht,bi as jt,n as At,bj as $t,R as Nt,r as R,bk as zt}from"./dfc316c3.js";var vt=1/0,Bt=17976931348623157e292;function Gt(t){if(!t)return t===0?t:0;if(t=Ht(t),t===vt||t===-vt){var e=t<0?-1:1;return e*Bt}return t===t?t:0}function Jt(t){var e=Gt(t),n=e%1;return e===e?n?e-n:e:0}function Kt(t,e,n,r){for(var s=t.length,o=n+(r?1:-1);r?o--:++o<s;)if(e(t[o],o,t))return o;return-1}function Yt(t){return function(e,n,r){var s=Object(e);if(!jt(e)){var o=At(n);e=$t(e),n=function(f){return o(s[f],f,s)}}var a=t(e,n,r);return a>-1?s[o?e[a]:a]:void 0}}var Xt=Math.max;function Qt(t,e,n){var r=t==null?0:t.length;if(!r)return-1;var s=n==null?0:Jt(n);return s<0&&(s=Xt(r+s,0)),Kt(t,At(e),s)}var Zt=Yt(Qt);const Ie=Zt,V=new WeakMap,Ot={},M=()=>{},O=M(),it=Object,u=t=>t===O,x=t=>typeof t=="function",W=(t,e)=>({...t,...e}),mt="undefined",nt=typeof window!=mt,lt=typeof document!=mt,te=()=>nt&&typeof window.requestAnimationFrame!=mt,Vt=(t,e)=>{const n=V.get(t);return[()=>t.get(e)||Ot,r=>{const s=t.get(e);n[5](e,W(s,r),s||Ot)},n[6]]},et=new WeakMap;let ee=0;const K=t=>{const e=typeof t,n=t&&t.constructor,r=n==Date;let s,o;if(it(t)===t&&!r&&n!=RegExp){if(s=et.get(t),s)return s;if(s=++ee+"~",et.set(t,s),n==Array){for(s="@",o=0;o<t.length;o++)s+=K(t[o])+",";et.set(t,s)}if(n==it){s="#";const a=it.keys(t).sort();for(;!u(o=a.pop());)u(t[o])||(s+=o+":"+K(t[o])+",");et.set(t,s)}}else s=r?t.toJSON():e=="symbol"?t.toString():e=="string"?JSON.stringify(t):""+t;return s};let dt=!0;const ne=()=>dt,[Et,ht]=nt&&window.addEventListener?[window.addEventListener.bind(window),window.removeEventListener.bind(window)]:[M,M],se=()=>{const t=lt&&document.visibilityState;return u(t)||t!=="hidden"},re=t=>(lt&&document.addEventListener("visibilitychange",t),Et("focus",t),()=>{lt&&document.removeEventListener("visibilitychange",t),ht("focus",t)}),oe=t=>{const e=()=>{dt=!0,t()},n=()=>{dt=!1};return Et("online",e),Et("offline",n),()=>{ht("online",e),ht("offline",n)}},ie={isOnline:ne,isVisible:se},ae={initFocus:re,initReconnect:oe},Dt=!Nt.useId,Y=!nt||"Deno"in window,ce=t=>te()?window.requestAnimationFrame(t):setTimeout(t,1),at=Y?R.useEffect:R.useLayoutEffect,ct=typeof navigator<"u"&&navigator.connection,yt=!Y&&ct&&(["slow-2g","2g"].includes(ct.effectiveType)||ct.saveData),Tt=t=>{if(x(t))try{t=t()}catch{t=""}const e=t;return t=typeof t=="string"?t:(Array.isArray(t)?t.length:t)?K(t):"",[t,e]};let ue=0;const Rt=()=>++ue,xt=0,Lt=1,Ft=2;var ut={__proto__:null,FOCUS_EVENT:xt,RECONNECT_EVENT:Lt,MUTATE_EVENT:Ft};async function Mt(...t){const[e,n,r,s]=t,o=W({populateCache:!0,throwOnError:!0},typeof s=="boolean"?{revalidate:s}:s||{});let a=o.populateCache;const f=o.rollbackOnError;let E=o.optimisticData;const y=o.revalidate!==!1,_=S=>typeof f=="function"?f(S):f!==!1,b=o.throwOnError;if(x(n)){const S=n,l=[],i=e.keys();for(let v=i.next();!v.done;v=i.next()){const I=v.value;!I.startsWith("$inf$")&&S(e.get(I)._k)&&l.push(I)}return Promise.all(l.map(g))}return g(n);async function g(S){const[l]=Tt(S);if(!l)return;const[i,v]=Vt(e,l),[I,A,P]=V.get(e),U=I[l],H=()=>y&&(delete P[l],U&&U[0])?U[0](Ft).then(()=>i().data):i().data;if(t.length<3)return H();let c=r,w;const L=Rt();A[l]=[L,0];const j=!u(E),X=i(),k=X.data,Q=X._c,F=u(Q)?k:Q;if(j&&(E=x(E)?E(F):E,v({data:E,_c:F})),x(c))try{c=c(F)}catch(D){w=D}if(c&&x(c.then))if(c=await c.catch(D=>{w=D}),L!==A[l][0]){if(w)throw w;return c}else w&&j&&_(w)&&(a=!0,c=F,v({data:c,_c:O}));a&&(w||(x(a)&&(c=a(c,F)),v({data:c,_c:O}))),A[l][1]=Rt();const Z=await H();if(v({_c:O}),w){if(b)throw w;return}return a?Z:c}}const It=(t,e)=>{for(const n in t)t[n][0]&&t[n][0](e)},fe=(t,e)=>{if(!V.has(t)){const n=W(ae,e),r={},s=Mt.bind(O,t);let o=M;const a={},f=(_,b)=>{const g=a[_]||[];return a[_]=g,g.push(b),()=>g.splice(g.indexOf(b),1)},E=(_,b,g)=>{t.set(_,b);const S=a[_];if(S)for(let l=S.length;l--;)S[l](g,b)},y=()=>{if(!V.has(t)&&(V.set(t,[r,{},{},{},s,E,f]),!Y)){const _=n.initFocus(setTimeout.bind(O,It.bind(O,r,xt))),b=n.initReconnect(setTimeout.bind(O,It.bind(O,r,Lt)));o=()=>{_&&_(),b&&b(),V.delete(t)}}};return y(),[t,s,y,o]}return[t,V.get(t)[4]]},le=(t,e,n,r,s)=>{const o=n.errorRetryCount,a=s.retryCount,f=~~((Math.random()+.5)*(1<<(a<8?a:8)))*n.errorRetryInterval;!u(o)&&a>o||setTimeout(r,f,s)},de=(t,e)=>K(t)==K(e),[Wt,Ee]=fe(new Map),he=W({onLoadingSlow:M,onSuccess:M,onError:M,onErrorRetry:le,onDiscarded:M,revalidateOnFocus:!0,revalidateOnReconnect:!0,revalidateIfStale:!0,shouldRetryOnError:!0,errorRetryInterval:yt?1e4:5e3,focusThrottleInterval:5*1e3,dedupingInterval:2*1e3,loadingTimeout:yt?5e3:3e3,compare:de,isPaused:()=>!1,cache:Wt,mutate:Ee,fallback:{}},ie),Re=(t,e)=>{const n=W(t,e);if(e){const{use:r,fallback:s}=t,{use:o,fallback:a}=e;r&&o&&(n.use=r.concat(o)),s&&a&&(n.fallback=W(s,a))}return n},me=R.createContext({}),Ut=nt&&window.__SWR_DEVTOOLS_USE__,Te=Ut?window.__SWR_DEVTOOLS_USE__:[],_e=()=>{Ut&&(window.__SWR_DEVTOOLS_REACT__=Nt)},pe=t=>x(t[1])?[t[0],t[1],t[2]||{}]:[t[0],null,(t[1]===null?t[2]:t[1])||{}],be=()=>W(he,R.useContext(me)),we=t=>(e,n,r)=>t(e,n&&((...o)=>{const a=Tt(e)[0],[,,,f]=V.get(Wt),E=f[a];return E?(delete f[a],E):n(...o)}),r),Ce=Te.concat(we),ge=t=>function(...n){const r=be(),[s,o,a]=pe(n),f=Re(r,a);let E=t;const{use:y}=f,_=(y||[]).concat(Ce);for(let b=_.length;b--;)E=_[b](E);return E(s,o||f.fetcher||null,f)},Se=(t,e,n)=>{const r=e[t]||(e[t]=[]);return r.push(n),()=>{const s=r.indexOf(n);s>=0&&(r[s]=r[r.length-1],r.pop())}};_e();const ft={dedupe:!0},ve=(t,e,n)=>{const{cache:r,compare:s,suspense:o,fallbackData:a,revalidateOnMount:f,refreshInterval:E,refreshWhenHidden:y,refreshWhenOffline:_,keepPreviousData:b}=n,[g,S,l]=V.get(r),[i,v]=Tt(t),I=R.useRef(!1),A=R.useRef(!1),P=R.useRef(i),U=R.useRef(e),H=R.useRef(n),c=()=>H.current,w=()=>c().isVisible()&&c().isOnline(),[L,j,X]=Vt(r,i),k=R.useRef({}).current,Q=u(a)?n.fallback[i]:a,F=(d,m)=>{let h=!0;for(const T in k){const p=T;s(m[p],d[p])||p==="data"&&u(d[p])&&s(m[p],rt)||(h=!1)}return h},Z=R.useMemo(()=>{const d=(()=>!i||!e?!1:u(f)?!(c().isPaused()||o):f)(),m=()=>{const T=L(),p=W(T);return delete p._k,d?{isValidating:!0,isLoading:!0,...p}:p};let h=m();return()=>{const T=m();return F(T,h)?h:h=T}},[r,i]),D=zt.useSyncExternalStore(R.useCallback(d=>X(i,(m,h)=>{F(m,h)||d()}),[r,i]),Z,Z),_t=!I.current,$=D.data,q=u($)?Q:$,st=D.error,pt=R.useRef(q),rt=b?u($)?pt.current:$:q,bt=(()=>_t&&!u(f)?f:c().isPaused()?!1:o?u(q)?!1:n.revalidateIfStale:u(q)||n.revalidateIfStale)(),wt=!!(i&&e&&_t&&bt),kt=u(D.isValidating)?wt:D.isValidating,qt=u(D.isLoading)?wt:D.isLoading,B=R.useCallback(async d=>{const m=U.current;if(!i||!m||A.current||c().isPaused())return!1;let h,T,p=!0;const G=d||{},z=!l[i]||!G.dedupe,J=()=>Dt?!A.current&&i===P.current&&I.current:i===P.current,tt={isValidating:!1,isLoading:!1},Ct=()=>{j(tt)},gt=()=>{const C=l[i];C&&C[1]===T&&delete l[i]},St={isValidating:!0};u(L().data)&&(St.isLoading=!0);try{if(z&&(j(St),n.loadingTimeout&&u(L().data)&&setTimeout(()=>{p&&J()&&c().onLoadingSlow(i,n)},n.loadingTimeout),l[i]=[m(v),Rt()]),[h,T]=l[i],h=await h,z&&setTimeout(gt,n.dedupingInterval),!l[i]||l[i][1]!==T)return z&&J()&&c().onDiscarded(i),!1;tt.error=O;const C=S[i];if(!u(C)&&(T<=C[0]||T<=C[1]||C[1]===0))return Ct(),z&&J()&&c().onDiscarded(i),!1;const N=L().data;tt.data=s(N,h)?N:h,z&&J()&&c().onSuccess(h,i,n)}catch(C){gt();const N=c(),{shouldRetryOnError:ot}=N;N.isPaused()||(tt.error=C,z&&J()&&(N.onError(C,i,N),(ot===!0||x(ot)&&ot(C))&&w()&&N.onErrorRetry(C,i,N,B,{retryCount:(G.retryCount||0)+1,dedupe:!0})))}return p=!1,Ct(),!0},[i,r]),Pt=R.useCallback((...d)=>Mt(r,P.current,...d),[]);if(at(()=>{U.current=e,H.current=n,u($)||(pt.current=$)}),at(()=>{if(!i)return;const d=B.bind(O,ft);let m=0;const T=Se(i,g,p=>{if(p==ut.FOCUS_EVENT){const G=Date.now();c().revalidateOnFocus&&G>m&&w()&&(m=G+c().focusThrottleInterval,d())}else if(p==ut.RECONNECT_EVENT)c().revalidateOnReconnect&&w()&&d();else if(p==ut.MUTATE_EVENT)return B()});return A.current=!1,P.current=i,I.current=!0,j({_k:v}),bt&&(u(q)||Y?d():ce(d)),()=>{A.current=!0,T()}},[i]),at(()=>{let d;function m(){const T=x(E)?E(q):E;T&&d!==-1&&(d=setTimeout(h,T))}function h(){!L().error&&(y||c().isVisible())&&(_||c().isOnline())?B(ft).then(m):m()}return m(),()=>{d&&(clearTimeout(d),d=-1)}},[E,y,_,i]),R.useDebugValue(rt),o&&u(q)&&i)throw!Dt&&Y?new Error("Fallback data is required when using suspense in SSR."):(U.current=e,H.current=n,A.current=!1,u(st)?B(ft):st);return{mutate:Pt,get data(){return k.data=!0,rt},get error(){return k.error=!0,st},get isValidating(){return k.isValidating=!0,kt},get isLoading(){return k.isLoading=!0,qt}}};var Ae=ge(ve);const Oe=R.createContext({models:[],isLoading:!1,error:void 0}),De=()=>R.useContext(Oe),Ne=De;export{Oe as M,be as a,Ne as b,Ie as f,Ae as u};
